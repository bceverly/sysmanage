# SonarQube/SonarCloud Configuration for SysManage Server
# Full-stack application analysis (Python backend + TypeScript/React frontend)

# Project identification
sonar.projectKey=bceverly_sysmanage
sonar.organization=bceverly
sonar.projectName=SysManage Server
sonar.projectVersion=1.0.0

# Source directories
sonar.sources=backend,frontend/src
sonar.tests=tests,frontend/src/__tests__

# Python-specific properties
sonar.python.version=3.10,3.11,3.12,3.13

# JavaScript/TypeScript exclusions - prevents Node.js bridge from walking restricted directories
sonar.javascript.exclusions=data/**,**/node_modules/**,installer/**,contrib/**,alembic/**

# Encoding
sonar.sourceEncoding=UTF-8

# Test coverage - uncomment these when running with coverage reports (e.g., in CI)
# Note: Coverage sensors walk the entire directory tree, which fails if restricted
# directories like data/openbao exist. Generate coverage reports first, then scan.
# sonar.python.coverage.reportPaths=coverage.xml
# sonar.javascript.lcov.reportPaths=frontend/coverage/lcov.info
# sonar.typescript.lcov.reportPaths=frontend/coverage/lcov.info

# Global exclusions - prevents scanner from entering these directories at all
# Note: data/** contains OpenBAO/Vault runtime data with restricted permissions
sonar.global.exclusions=data/**,**/node_modules/**,.venv/**,venv/**

# Source exclusions
sonar.exclusions=**/test_*.py,**/__pycache__/**,**/.venv/**,**/venv/**,**/build/**,**/dist/**,**/*.pyc,**/node_modules/**,**/coverage/**,frontend/dist/**,frontend/build/**,**/*.test.ts,**/*.test.tsx,**/*.spec.ts,**/*.spec.tsx,data/**,**/storage/**,**/*.so,**/*.pyd,installer/**,contrib/**

# Test exclusions
sonar.test.exclusions=**/test_*.py,**/*.test.ts,**/*.test.tsx,**/*.spec.ts,**/*.spec.tsx,tests/**,frontend/src/__tests__/**

# Duplication exclusions (migrations, test fixtures, etc.)
sonar.cpd.exclusions=**/migrations/**,**/alembic/**,**/test_*.py,**/conftest.py

# Rule suppressions for FastAPI modern patterns
# S8410: Use Annotated type hints for FastAPI DI - modern pattern, existing code uses classic = Depends()
# S8415: Document HTTPException in responses - documentation pattern, not a bug
sonar.issue.ignore.multicriteria=e1,e2
sonar.issue.ignore.multicriteria.e1.ruleKey=python:S8410
sonar.issue.ignore.multicriteria.e1.resourceKey=backend/api/**
sonar.issue.ignore.multicriteria.e2.ruleKey=python:S8415
sonar.issue.ignore.multicriteria.e2.resourceKey=backend/api/**

# Links
sonar.links.homepage=https://github.com/bceverly/sysmanage
sonar.links.ci=https://github.com/bceverly/sysmanage/actions
sonar.links.scm=https://github.com/bceverly/sysmanage
sonar.links.issue=https://github.com/bceverly/sysmanage/issues
